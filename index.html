<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>معلومات الحاج</title>
    <style>
        /* --- Base Styles & Variables --- */
        :root {
            --primary-color: #00695C; /* Teal/Green - Hajj related color */
            --secondary-color: #1A535C; /* Darker Blue/Teal */
            --accent-color: #D4AF37; /* Gold/Sand */
            --danger-color: #D32F2F; /* Softer Red */
            --light-bg: #fdfaf6; /* Very light beige */
            --white-bg: #ffffff;
            --text-dark: #333333;
            --text-medium: #555555;
            --text-light: #777777;
            --border-color: #e0e0e0;
            --subtle-border: #f0f0f0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --radius-sm: 5px;
            --radius-md: 10px;
        }

        body {
            font-family: 'Tahoma', 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--light-bg); /* Lighter, warmer background */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: var(--text-dark);
        }

        /* --- Logos --- */
        .logos-container {
            width: 100%;
            background-color: var(--white-bg);
            padding: 15px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 2px solid var(--border-color);
            gap: 50px; /* Increased gap */
            box-sizing: border-box;
            flex-shrink: 0;
            box-shadow: 0 1px 3px var(--shadow-color); /* Subtle shadow */
        }
        .logos-container img {
            height: 55px; /* Slightly larger */
            max-width: 160px;
            object-fit: contain;
        }

        /* --- Main Content Area --- */
        .content-container {
            background: linear-gradient(135deg, var(--white-bg) 0%, #fdfdff 100%); /* Subtle gradient */
            padding: 30px 35px; /* Increased padding */
            margin: 30px 20px;
            border-radius: var(--radius-md);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08); /* Softer shadow */
            width: 90%;
            max-width: 800px; /* Slightly wider max width */
            box-sizing: border-box;
            text-align: right;
            flex-grow: 1;
        }

        /* --- Page Title --- */
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 2em; /* Larger */
            font-weight: bold;
            position: relative; /* For pseudo-element */
            padding-bottom: 10px;
        }
        h1::after { /* Decorative underline */
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
            margin: 10px auto 0;
            border-radius: 2px;
        }

        /* --- Pilgrim Profile Section Layout --- */
        .pilgrim-profile-section {
             display: flex;
             align-items: flex-start; /* Align items to the top */
             gap: 30px;
             margin-bottom: 25px;
             padding-bottom: 25px;
             border-bottom: 1px solid var(--subtle-border);
        }

        .pilgrim-photo-container {
             flex-shrink: 0;
             position: relative; /* For potential decorative elements */
             padding-top: 5px; /* Align visually better with text */
        }

        .pilgrim-photo {
            display: block;
            width: 135px; height: 135px; /* Slightly larger */
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto;
            border: 5px solid var(--white-bg); /* White border */
            outline: 2px solid var(--primary-color); /* Colored outline */
            background-color: #eee;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        }

        .pilgrim-main-info {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .pilgrim-name-id-line {
             margin-bottom: 15px; /* Space below name/ID */
        }

        .pilgrim-name-h { /* Main name styling */
             font-size: 1.7em; /* Larger */
             font-weight: bold;
             color: var(--secondary-color);
             display: block; /* Takes full line */
             margin-bottom: 5px; /* Space between name and ID */
        }
        #pilgrim-id-display { /* Style for ID below name */
            font-size: 0.95em;
            color: var(--text-light);
            display: block; /* Full line */
            margin-top: -5px; /* Pull slightly closer to name */
        }

        /* --- Details Sections (Grid) --- */
        #info-panel-basic-details, #info-panel-additional-details {
            display: grid;
            /* Responsive grid columns */
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px 25px; /* More row gap */
        }
        #info-panel-additional-details {
            margin-top: 25px; /* Increased spacing */
            padding-top: 25px;
            /* Creative separator */
            position: relative; /* For pseudo-element */
        }
        /* Replacing dashed line with a more subtle one */
        #info-panel-additional-details::before {
             content: '';
             position: absolute;
             top: 0;
             right: 10%; /* Indent */
             left: 10%; /* Indent */
             height: 1px;
             background: linear-gradient(to left, transparent, var(--border-color), transparent); /* Fading line */
             margin-top: 0;
             opacity: 0.8;
        }


        /* Styling individual info points */
        #info-panel-basic-details p, #info-panel-additional-details p {
            margin: 0; /* Reset margin */
            padding: 8px 0; /* Add vertical padding */
            font-size: 1.05em; /* Slightly larger font */
            color: var(--text-medium);
            border-bottom: 1px solid var(--subtle-border); /* Lighter border */
            display: flex; /* Use flex for label/value alignment */
            justify-content: space-between;
            align-items: baseline;
        }
        /* Label Styling */
        #info-panel-basic-details strong, #info-panel-additional-details strong {
            color: var(--primary-color); /* Use primary color for labels */
            font-weight: bold; /* Make labels bolder */
            margin-left: 10px; /* Space after label */
            white-space: nowrap; /* Prevent label wrapping */
            flex-shrink: 0; /* Prevent label shrinking */
        }
         /* Value Styling */
        #info-panel-basic-details span:not(.location-link span),
        #info-panel-additional-details span {
             color: var(--text-dark);
             text-align: left; /* Align value to the left within its space */
        }

        .location-link {
             color: #007bff; /* Standard link blue */
             text-decoration: none;
             font-weight: normal; /* Normal weight for the link text */
             display: inline-block;
        }
        .location-link:hover { text-decoration: underline; color: #0056b3; }

        /* --- Buttons --- */
        .button-container {
            text-align: center; /* Center buttons */
            margin-top: 25px;
            padding-top: 15px; /* Space above first button */
            display: flex;
            justify-content: center; /* Center horizontally */
            align-items: center; /* Align vertically if wrapped */
            gap: 15px; /* Space between buttons */
            flex-wrap: wrap; /* Allow buttons to wrap on small screens */
        }
         /* Style for the main info buttons (non-emergency) */
        .pilgrim-main-info .button-container {
            margin-top: 10px; /* Less margin when it's under the name */
            justify-content: flex-start; /* Align left (or right in RTL) under name */
            padding-top: 0;
        }

        .info-page-button {
            padding: 10px 25px; /* Slightly more padding */
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.25s ease, transform 0.15s ease;
            display: inline-block;
        }
        .info-page-button:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px); /* Subtle lift effect */
        }

        #emergency-button {
            background-color: var(--danger-color);
            font-size: 1.1em;
            padding: 12px 30px; /* Larger padding */
        }
        #emergency-button:hover {
            background-color: #a72a2a; /* Darker red on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(211, 47, 47, 0.3);
        }

         /* Toggle button specifically */
        #toggle-info-button {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 8px 20px;
        }
        #toggle-info-button:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }


        /* --- Custom Alert Modal (No design change needed from previous) --- */
        #custom-alert-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); display: none; justify-content: center; align-items: center; z-index: 1000; }
        #custom-alert-box { background-color: #fff; padding: 30px 40px; border-radius: var(--radius-md); box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2); text-align: center; max-width: 85%; width: 450px; /* Slightly larger */ }
        #custom-alert-message { font-size: 1.5em; color: var(--text-dark); margin-bottom: 30px; line-height: 1.6; }
        #custom-alert-close-button { padding: 12px 30px; background-color: var(--primary-color); color: white; border: none; border-radius: var(--radius-sm); cursor: pointer; font-size: 1.05em; font-weight: bold; transition: background-color 0.2s ease; }
        #custom-alert-close-button:hover { background-color: var(--secondary-color); }


         /* --- Toggle Animation --- */
         #info-panel-additional-details {
            transition: max-height 0.5s ease-in-out, opacity 0.4s ease-in-out, padding-top 0.5s ease-in-out, margin-top 0.5s ease-in-out;
            overflow: hidden; /* Crucial for max-height animation */
            max-height: 0; /* Start hidden */
            opacity: 0; /* Start invisible */
            padding-top: 0; /* Remove padding when hidden */
            margin-top: 0; /* Remove margin when hidden */
            border-top: none; /* Hide border when collapsed (will rely on ::before) */
        }

         #info-panel-additional-details.visible {
            max-height: 1500px; /* Arbitrarily large value to allow content to expand */
            opacity: 1;
            padding-top: 25px; /* Restore padding */
            margin-top: 25px; /* Restore margin */
            /* Bring back the separator via the pseudo-element (already defined) */
         }

        /* --- Mobile Responsiveness --- */
        @media (max-width: 768px) {
             .pilgrim-profile-section {
                flex-direction: column; /* Stack photo and info vertically */
                align-items: center; /* Center items when stacked */
                gap: 20px; /* Reduced gap */
                text-align: center; /* Center text in the info block */
             }
            .pilgrim-photo-container {
                 margin-bottom: 0; /* No extra margin needed */
                 padding-top: 0;
            }
            .pilgrim-main-info {
                align-items: center; /* Center name/ID/button block */
                width: 100%; /* Take full width */
            }
             .pilgrim-main-info .button-container {
                justify-content: center; /* Center the button */
                margin-top: 15px;
            }
            .pilgrim-name-h { text-align: center; font-size: 1.5em;}
            #pilgrim-id-display { text-align: center; }

             #info-panel-basic-details p, #info-panel-additional-details p {
                 flex-direction: column; /* Stack label and value vertically */
                 align-items: flex-start; /* Align to start (right in RTL) */
                 padding: 10px 5px; /* Adjust padding */
                 border-bottom: 1px solid var(--subtle-border);
             }
             #info-panel-basic-details strong, #info-panel-additional-details strong {
                 margin-bottom: 3px; /* Space below label */
                 margin-left: 0;
                 min-width: auto; /* Reset min-width */
             }
             #info-panel-basic-details span:not(.location-link span),
             #info-panel-additional-details span {
                 text-align: right; /* Align value text to right */
                 width: 100%; /* Take full width */
                 padding-right: 10px; /* Indent value slightly */
                 font-size: 0.95em;
                 color: var(--text-medium);
             }
             #info-panel-additional-details::before { /* Make separator line shorter on mobile */
                 right: 5%;
                 left: 5%;
             }

            .button-container { flex-direction: column; gap: 10px; } /* Stack main page buttons */
        }

        @media (max-width: 600px) {
            .logos-container { gap: 30px; }
            .logos-container img { height: 45px; }
            .content-container { margin: 20px 15px; padding: 20px; }
            h1 { font-size: 1.7em; }
            .pilgrim-photo { width: 110px; height: 110px; }
            .pilgrim-name-h { font-size: 1.4em; }
            #info-panel-basic-details, #info-panel-additional-details { grid-template-columns: 1fr; gap: 10px 15px; }

            #info-panel-basic-details p, #info-panel-additional-details p { font-size: 1em; }

            .info-page-button { font-size: 0.95em; padding: 9px 20px; width: 80%; /* Make buttons wider */ }
            #emergency-button { font-size: 1em; padding: 11px 25px; width: 85%; }
            .pilgrim-main-info .button-container { width: 100%; align-items: center; /* Center button under name */}
            #emergency-button.pilgrim-action-button { width: 85%; } /* Ensure width if it's the only button there */

            #custom-alert-box { width: 90%; padding: 25px 20px; }
            #custom-alert-message { font-size: 1.3em; }
            #custom-alert-close-button { font-size: 1em; padding: 10px 22px; }
        }

    </style>
</head>
<body>
    <!-- Logos Section -->
    <div class="logos-container">
         <img src="https://cdn.discordapp.com/attachments/860307816837546024/1358016916106776757/hajj-icon.png?ex=67f643cf&is=67f4f24f&hm=e67334eb1046c4c0d33879b59fa25de3e1e4c460d6be52c1be06d58a3332e31d&" alt="شعار الحج والعمرة">
         <img src="https://cdn.discordapp.com/attachments/860307816837546024/1358016924058910821/kfsc.jpg?ex=67f643d1&is=67f4f251&hm=fe6c695a3af856e20299dbde56e54070dba47d28815f4caceca6a6e5b996c104&" alt="شعار مركز الملك سلمان">
    </div>

    <div class="content-container">
        <h1>معلومات الحاج</h1>

        <!-- Pilgrim Profile Section -->
        <div class="pilgrim-profile-section">
            <div class="pilgrim-photo-container">
                <!-- !! IMPORTANT: Replace src with the actual URL !! -->
                <img src="https://i.pravatar.cc/150?img=1" alt="صورة الحاج" class="pilgrim-photo" id="pilgrim-photo-detail">
            </div>

            <div class="pilgrim-main-info">
                <div class="pilgrim-name-id-line">
                    <span class="pilgrim-name-h" id="pilgrim-name-h">صالح الغامدي</span>
                    <!-- Display ID under the name -->
                    <span id="pilgrim-id-display">المعرف: P1002</span>
                </div>
                 <!-- Emergency button moved under name/ID for better context -->
                 <div class="button-container">
                    <button id="emergency-button" class="info-page-button pilgrim-action-button">نداء طوارئ</button>
                    <!-- Optional: Add other primary action buttons here if needed -->
                </div>
            </div>
        </div> <!-- End pilgrim-profile-section -->

        <!-- Details Section -->
        <div class="details-section-container">
            <!-- === Basic Info Section === -->
            <div id="info-panel-basic-details">
                <!-- !! Data filled via JS or dynamically in production !! -->
                 <p><strong>حالة التصريح:</strong> <span id="permit-status">مصرح</span></p>
                 <p><strong>الجنسية:</strong> <span id="pilgrim-nationality">سعودي</span></p>
                 <p><strong>العمر:</strong> <span id="pilgrim-age">45</span></p>
                 <p><strong>الجنس:</strong> <span id="pilgrim-gender">ذكر</span></p>
                 <p><strong>رقم الجوال:</strong> <span id="phone-number">0512345678</span></p>
                 <p><strong>مشاكل صحية:</strong> <span id="medical-history">سكري النوع الثاني</span></p>
                 <!-- Location gets special handling by JS -->
                 <p><strong>الموقع الحالي:</strong> <span id="coordinates">21.41950, 39.88880</span></p>
            </div>

             <!-- Toggle Button - Placed before the additional info -->
            <div class="button-container" id="toggle-info-button-container">
                 <button id="toggle-info-button" class="info-page-button">عرض المزيد من المعلومات <span class="toggle-arrow">▼</span></button>
            </div>

            <!-- === Additional Info Section (Initially Hidden, animated) === -->
            <div id="info-panel-additional-details" > <!-- class="visible" will be added by JS -->
                <p><strong>رقم الجواز:</strong> <span id="passport-number">XQ9876543</span></p>
                <p><strong>رقم الهوية/الإقامة:</strong> <span id="national-id">1098765432</span></p>
                <p><strong>تاريخ انتهاء الجواز:</strong> <span id="passport-expiry">١٥/‏٥/‏٢٠٢٨</span></p>
                <p><strong>رقم التصريح:</strong> <span id="permit-number">H12345678</span></p>
                <p><strong>اسم الفندق:</strong> <span id="hotel-name">برج ساعة مكة الملكي فيرمونت</span></p>
                <p><strong>اسم الحملة:</strong> <span id="campaign-name">حملة الراجحي</span></p>
                <p><strong>رقم جوال للطوارئ:</strong> <span id="emergency-phone">0587654321</span></p>
                <p><strong>السجل الجنائي:</strong> <span id="criminal-record">لا يوجد</span></p>
                <p><strong>جهة القدوم:</strong> <span id="arrival-point">مطار الملك عبدالعزيز الدولي</span></p>
                <p><strong>تاريخ الوصول:</strong> <span id="arrival-date">٥/‏٦/‏٢٠٢٤</span></p>
                <p><strong>تاريخ المغادرة:</strong> <span id="departure-date">٢٥/‏٦/‏٢٠٢٤</span></p>
            </div>
        </div> <!-- End details-section-container -->

    </div> <!-- End content-container -->

    <!-- Custom Alert Modal Structure -->
    <div id="custom-alert-overlay">
        <div id="custom-alert-box">
            <p id="custom-alert-message">الرسالة هنا</p>
            <button id="custom-alert-close-button">إغلاق</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const emergencyButton = document.getElementById('emergency-button');
            const pilgrimNameElement = document.getElementById('pilgrim-name-h');
            const pilgrimIdElement = document.getElementById('pilgrim-id'); // Get original ID element
            const pilgrimIdDisplay = document.getElementById('pilgrim-id-display'); // The new display span

            const toggleInfoButton = document.getElementById('toggle-info-button');
            const toggleArrow = toggleInfoButton ? toggleInfoButton.querySelector('.toggle-arrow') : null;
            const additionalDetails = document.getElementById('info-panel-additional-details');

            const customAlertOverlay = document.getElementById('custom-alert-overlay');
            const customAlertMessage = document.getElementById('custom-alert-message');
            const customAlertCloseButton = document.getElementById('custom-alert-close-button');

            // --- Populate Pilgrim ID under name (if elements exist) ---
            // Note: In a real app, you'd fetch this data dynamically.
            // Here we copy it from the (now hidden or potentially removed) basic info section if needed.
             const pilgrimIdValue = pilgrimIdElement ? pilgrimIdElement.textContent : 'غير معروف'; // Fallback
             if(pilgrimIdDisplay && pilgrimIdValue !== 'غير معروف') {
                // Pilgrim ID might be removed from the main list later, so we grab its text content now
                pilgrimIdDisplay.textContent = `المعرف: ${pilgrimIdValue}`;
                // Optional: Remove the ID from the basic details list if desired
                 const idParagraph = document.querySelector('#info-panel-basic-details p strong:first-child')?.parentElement;
                // if(idParagraph && idParagraph.querySelector('strong').textContent.includes('المعرف')) {
                //     idParagraph.remove();
                // }
             } else if (pilgrimIdDisplay) {
                 pilgrimIdDisplay.textContent = `المعرف: غير معروف`; // Display fallback if source isn't found
             }


            const pilgrimName = pilgrimNameElement ? pilgrimNameElement.textContent.trim() : 'الحاج المحدد';

            // --- Emergency Button Listener ---
            if (emergencyButton) {
                emergencyButton.addEventListener('click', () => {
                    if (window.confirm(`هل أنت متأكد من إرسال نداء طوارئ للحاج ${pilgrimName}؟`)) {
                        showCustomAlert(`تم ترحيل البلاغ للهلال الأحمر للحاج ${pilgrimName}.`);
                        console.log(`ACTION: Emergency button clicked for ${pilgrimName}`);
                        // Optional: Visually indicate the button was pressed (e.g., temporarily disable, change style)
                        // emergencyButton.disabled = true;
                        // emergencyButton.style.opacity = '0.7';
                    } else {
                        console.log(`Emergency call cancelled for ${pilgrimName}.`);
                    }
                });
            }

            // --- Toggle Info Listener ---
             if (toggleInfoButton && additionalDetails && toggleArrow) {
                 toggleInfoButton.addEventListener('click', () => {
                    const isHidden = !additionalDetails.classList.contains('visible');

                    if (isHidden) {
                        additionalDetails.classList.add('visible');
                        toggleInfoButton.innerHTML = 'إخفاء المعلومات الإضافية <span class="toggle-arrow">▲</span>'; // Change text and arrow
                     } else {
                        additionalDetails.classList.remove('visible');
                        toggleInfoButton.innerHTML = 'عرض المزيد من المعلومات <span class="toggle-arrow">▼</span>'; // Change back
                    }
                });
             }


             // --- Clickable Location ---
             const coordinatesSpan = document.getElementById('coordinates');
             if (coordinatesSpan) {
                 const coordsText = coordinatesSpan.textContent.trim();
                 const coordsArray = coordsText.split(/,\s*/);
                 if (coordsArray.length === 2) {
                     const lat = parseFloat(coordsArray[0]);
                     const lon = parseFloat(coordsArray[1]);
                     if (!isNaN(lat) && !isNaN(lon)) {
                         const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${lat},${lon}`;
                         const link = document.createElement('a');
                         link.href = mapsUrl;
                         link.target = '_blank';
                         link.rel = 'noopener noreferrer';
                         link.className = 'location-link';
                         link.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="vertical-align: middle; margin-left: 5px;"><path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/></svg><span>${coordsText}</span>`; // Add simple map pin icon + text
                         coordinatesSpan.innerHTML = ''; // Clear existing text
                         coordinatesSpan.appendChild(link);
                     } else {
                          console.warn("Could not parse coordinates:", coordsText);
                          coordinatesSpan.textContent = 'غير متوفر'; // Indicate invalid data
                     }
                 } else {
                      console.warn("Coordinates format incorrect:", coordsText);
                      coordinatesSpan.textContent = 'غير متوفر'; // Indicate invalid data
                 }
             }


            // --- Custom Alert Functions ---
            function showCustomAlert(message) {
                if (!customAlertOverlay || !customAlertMessage) { console.error("Custom alert elements not found!"); alert(message); return; }
                customAlertMessage.textContent = message;
                customAlertOverlay.style.display = 'flex';
            }

            function hideCustomAlert() {
                if (customAlertOverlay) { customAlertOverlay.style.display = 'none'; }
            }

            // --- Custom Alert Close Listeners ---
            if (customAlertCloseButton) { customAlertCloseButton.addEventListener('click', hideCustomAlert); }
            if (customAlertOverlay) { customAlertOverlay.addEventListener('click', (event) => { if (event.target === customAlertOverlay) { hideCustomAlert(); } }); }

        }); // End DOMContentLoaded
    </script>

</body>
</html>
